{% assign form_data = site.data.forms.items | where: "category", include.reference %}
{% if form_data %}
{% assign form = form_data[0] %}
{{form_data.pre_text}}
{% assign fieldset_count = 1%}
<form class="form">
    {{form.pre_text | markdownify}}
    {% for field in form.form_fields %}
    {% if forloop.first == true %}
    <fieldset class="form__fieldset">
        {% elsif field.type == 'fieldset' %}
        {% assign fieldset_count = fieldset_count | plus: 1%}
        <div class="form__proceed"><button>Step {{fieldset_count | plus: 1}}</button></div>
    </fieldset>
    <fieldset class="form__fieldset">
        {% endif %}
        <div class="form__field">
            {% capture field_include %}field_{{field.type}}.html{% endcapture %}
            {% assign field_slug = field.name | slugify 'latin' %}
            {% if field.type == 'radio' %}
            {% include {{field_include |trim}} name=field.name slug=field_slug type=field.type options=field.options helptext=field.helptext %}
            {% else %}
            {% include {{field_include |trim}} name=field.name slug=field_slug type=field.type helptext=field.helptext %}
            {% endif %}
        </div>
        {% if forloop.last == true %}
            </fieldset>
        {%endif %}
    {% endfor %}
    <div class="form__fieldset-count">
        {% for i in (1..{{fieldset_count}}) %}
        <span>{{i}}</span>
        {% endfor %}
    </div>
</form>
{% endif %}